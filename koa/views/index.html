<!DOCTYPE html>
<html lang="en">

<head>
   <meta charset="UTF-8">
   <meta name="Description" content="Toy load balancing Docker app based on Nginx, Node.js, Sinatra  & Postgres">
   <meta http-equiv="X-UA-Compatible" content="IE=edge">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <meta name="theme-color" content="#317EFB" />
   <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
   <title>App</title>
</head>

<body>
   <img src="ruby.svg" height=40 width=40 alt="ruby" loading="lazy">
   <img src="sinatra.svg" height=40 width=40 alt="sinatra" loading="lazy">
   <img src="nodejs.svg" height=40 width=40 alt="nodejs" loading="lazy">
   <img src="docker.webp" height=40 width=40 alt="docker" loading="lazy">
   <img src="nginx.svg" height=40 width=40 alt="nginx" loading="lazy">

   <h4>
      Hello! You are connected to the PostgreSQL database:
      <%= db %>
   </h4>
   <p class="btn-center"> <button id='reload'> Refresh the page: <kbd>Ctrl-R</kbd></button></p>
   <p>
      <button>Navigate to: <a href="/ruby" alt="gotoruby">Ruby</a></button>

   </p>

   <ul style="list-style-type: none">
      <% data.forEach(request=> { %>
         <li>
            <% if (request && request.app=='Node' ) { %>
               <img src="nodejs.svg" height=20 width=20 alt="node" loading="lazy">
               <% } else { %>
                  <img src="ruby.svg" height=20 width=20 alt="ruby" loading="lazy">
                  <% } %> &nbsp
                     <%= request.app %> &nbsp
                        <%= request.host%> &nbsp
                           <%= request.count %>
         </li>
         <%}) %>
   </ul>
   <table>
      <% requests.forEach( request=> { %>
         <tr>
            <td>
               <% if (request && request.app=='Node' ) { %>
                  <img src="nodejs.svg" height=20 width=20 alt="node" loading="lazy">
                  <% } else { %>
                     <img src="ruby.svg" height=20 width=20 alt="ruby" loading="lazy">
                     <% } %>
            </td>
            <td>
               <%= request.url%> &nbsp | &nbsp
            </td>
            <td>
               <%= request.app %> &nbsp | &nbsp
            </td>
            <td>
               <%= request.ip %> &nbsp | &nbsp
            </td>
            <td>
               <%= request.host %>&nbsp | &nbsp
            </td>
            <td>
               <%= request.req_at %>&nbsp | &nbsp
            </td>
         </tr>
         <% }) %>
   </table>

   <script type="module" src="reload.js" async></script>
   <!-- ".js" should be located in same folder -->
</body>

</html>